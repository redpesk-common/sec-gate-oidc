{
  "name": "afb-oidc",
  "tracereq": "none",
  "verbose": 2,
  "port": 1234,
  "https": true,
  "https-cert": "../conf.d/project/ssl/devel-cert.pem",
  "https-key": "../conf.d/project/ssl/devel-key.pem",
  "extension": "libafb-sgate-oidc-ext.so",
  "roothttp": ".",
  "rootdir":  "../conf.d/project/htdocs",
  "binding" : [{"uid": "fedid-api", "path": "/usr/local/fedid-binding/lib/fedid-binding.so", "config": {"dbpath":"/var/tmp/fedid-sqllite.db"}}],
  "@extconfig": {
    "sgate-oidc": {

      "api": "sgate",
      "info": "oidc secure gate local authentication sample config",
      "globals": {
          "login": "/sgate/common/login.html",
          "register": "/sgate/common/register.html",
          "fedlink": "/sgate/common/fedlink.html",
          "error": "/sgate/common/error.html",
          "timeout": 600
      },

      "idps": {
            "uid": "nfc-scard",
            "type": "nfc-pcsc",
            "info": "Authentication via NFC Mifare or smart-card http://downloads.acs.com.hk/drivers/en/API-ACR122U-2.02.pdf",
            "statics": {
                "login": "/sgate/nfc/login",
                "logo": "/sgate/nfc/logo-64px.png",
                "timeout": 900
            },
            "plugin": {
                "info": "provide pluging path and reader name/id",
                "ldpath": "libidp-sgate-nfc-auth.so"
            },
            "schema":     {
                "info" : "NFC command list",
                "reader": "acr122",
                "keys": [
                    {"uid":"dflt-A", "idx": 0, "value": ["0xFF","0xFF","0xFF","0xFF","0xFF","0xFF"]},
                    {"uid":"dflt-B", "idx": 1, "value": ["0xFF","0xFF","0xFF","0xFF","0xFF","0xFF"]}
                ],
                "cmds": [
                    {"uid":"fedid", "action":"uuid"},
                    {"uid":"user", "action":"read", "blk":1, "len":16, "key":"dflt-A"},
                    {"uid":"admin", "action":"read", "blk":2, "len":16, "key":"dflt-A"}
                ]
            },
            "wellknown": {
                "tokenid": "/sgate/nfc/login.html"
            },
            "profiles": [
                {"uid":"basic", "loa":1, "scope":"fedid"},
                {"uid":"roles", "loa":2, "scope":"fedid, user"},
                {"uid":"roles", "loa":3, "scope":"fedid, user, admin"}
            ]
        },

      "apis": [
        {"uid": "fedid","info":"embedded social federated user identity svc","loa":0,"uri":"@fedid"},
        {"uid": "test1","lazy":1},
        {"uid": "test2","uri":"unix:@test2", "loa":1, "require": ["user"], "lazy":1},
        {"uid": "test3","uri":"tcp:localhost:1235/test3", "loa":2, "require": ["user","admin"], "lazy":1},
        {"uid": "simple","uri":"unix:/tmp/spawn-binding/simple", "loa":1, "require": ["user"], "lazy":1}
        ],
      "alias": [
        {"uid": "idp-common", "url":"/sgate/common", "path":"idps/common" },
        {"uid": "idp-github"  , "url":"/sgate/github","loa":0, "path":"idps/github" },
        {"uid": "idp-pam"     , "url":"/sgate/pam"   ,"loa":0, "path":"idps/pam" },
        {"uid": "idp-nfc"    , "url":"/sgate/nfc"   ,"loa":0, "path":"idps/nfc" },
        {"uid": "idp-phantauth" , "url":"/sgate/phantauth"   ,"loa":0, "path":"idps/phantauth" },
        {"uid": "idp-onelogin" , "url":"/sgate/onelogin"   ,"loa":0, "path":"idps/onelogin" },
        {"uid": "public" , "info": "Anonymous access allowed", "url":"/public", "path":"public" },
        {"uid": "private", "info": "Required basic authentication", "url":"/private",  "loa":1, "path":"private" },
        {"uid": "confidential", "info": "Required teams authentication", "url":"/confidential", "loa":2, "path":"confidential" },
        {"uid": "admin", "info": "Required admin security attribute", "url":"/admin", "loa":1, "path":"admin", "require": ["wheel","iotbzh","sudo"]},
      ]
    }
  }
}

